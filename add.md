# Что надо сделать и не забыть

- алерт на изменение robots.txt

Коротко: да, менять `robots.txt` через админку **можно**, так делают многие CMS. Но это файл с «ядерной кнопкой» для индексации — нужен аккуратный режим.

Что учесть, чтобы было корректно и безопасно:

* **Права и доступ**

  * Редактирование — только для суперпользователей или отдельного разрешения (например, `seo.change_robots`).
  * Включи 2FA для таких аккаунтов.

* **Валидация и защита от “Disallow: /”**

  * Линтинг синтаксиса: разрешить только допустимые директивы (`User-agent`, `Disallow`, `Allow`, `Sitemap`, опционально `Crawl-delay`).
  * Явное предупреждение/подтверждение при попытке поставить `Disallow: /` в проде.
  * Предпросмотр результата перед сохранением.

* **Версионирование и откат**

  * Храни историю изменений (audit log) и давай быстрый rollback к предыдущей версии.

* **Окружения**

  * Staging/preview — по умолчанию `Disallow: /`.
  * Production — безопасный дефолт, чтобы при пустом или битом значении не заблокировать сайт.

* **Кеширование и доставка**

  * Отдавай с `Content-Type: text/plain; charset=utf-8`.
  * Кешируй на 1–5 минут; при сохранении — инвалидируй CDN/Reverse proxy.
  * Фолбэк: если БД недоступна, возвращай статический безопасный вариант.

* **Мультисайт/мультиязык**

  * Один `robots.txt` на домен: подставляй корректный `Sitemap: https://<host>/sitemap.xml` для каждого хоста (через `django.contrib.sites`/ваш `SiteSetup`).
  * Не нужно перечислять языковые префиксы — правила и так применяются по путям.

* **Не раскрывай лишнего**

  * Не перечисляй «секретные» эндпойнты — `robots.txt` публичен. Безопасность должна обеспечиваться авторизацией, а не Disallow.

* **Мониторинг**

  * Алёрт при изменении `robots.txt` в проде (и отдельно — при появлении `Disallow: /`).
  * Периодическая автопроверка HTTP 200 на `/robots.txt`.

* **Процессы**

  * Желательно ревью изменений (минимум — второй глаз).
  * После правки — проверить Search Console/Bing Webmaster и логи бота.

Если кратко: динамический `robots.txt` через админку — ок, но только с валидацией, историей, ограниченными правами и безопасными дефолтами/фолбэком. Без этого риск «случайно деиндексировать весь сайт» слишком велик.

- дать страницам (например, обмен, блог/faq) возможность переопределять title/description/OG/Twitter поверх дефолтов из SiteSetup.