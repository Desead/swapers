{% extends "base.html" %}
{% load i18n %}

{% block content %}
  <h1>{{ main_h1|default:_("Главная") }}</h1>
  {% if main_subtitle %}
    <p>{{ main_subtitle }}</p>
  {% else %}
    <p>{% trans "Минимальная стартовая страница." %}</p>
  {% endif %}

  {% if monitorings %}
    <hr class="mt-6 mb-4">

    <section aria-labelledby="partner-monitorings">
      <h2 id="partner-monitorings" style="position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;">
        {% trans "Мониторинги" %}
      </h2>

      <!-- Баннеры в строку с переносами; БЕЗ <style>, только style-атрибуты -->
      <div style="display:flex;flex-wrap:wrap;gap:10px 12px;align-items:center;">
        {% for m in monitorings %}
          {% with light=m.banner_light_url dark=m.banner_dark_url %}
            {% if light or dark %}
              <div style="flex:0 0 auto;">
                {% if m.link %}
                  <a href="{{ m.link }}" rel="nofollow noopener" target="_blank"
                     {% if m.title %}title="{{ m.title }}"{% endif %}>
                    <!-- Рамка 88×31, содержимое вписывается с сохранением пропорций -->
                    <span style="width:88px;height:31px;display:flex;align-items:center;justify-content:center;overflow:hidden;" aria-label="{{ m.name }}">
                      <picture>
                        {# в тёмной теме показываем «светлый» баннер (если есть) #}
                        {% if light %}<source media="(prefers-color-scheme: dark)" srcset="{{ light }}">{% endif %}
                        <img
                          src="{{ dark|default:light }}"
                          alt="{{ m.name }}"
                          loading="lazy"
                          style="max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;display:block;"
                        >
                      </picture>
                    </span>
                  </a>
                {% else %}
                  <span style="width:88px;height:31px;display:flex;align-items:center;justify-content:center;overflow:hidden;"
                        aria-label="{{ m.name }}"
                        {% if m.title %}title="{{ m.title }}"{% endif %}>
                    <picture>
                      {% if light %}<source media="(prefers-color-scheme: dark)" srcset="{{ light }}">{% endif %}
                      <img
                        src="{{ dark|default:light }}"
                        alt="{{ m.name }}"
                        loading="lazy"
                        style="max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;display:block;"
                      >
                    </picture>
                  </span>
                {% endif %}
              </div>
            {% endif %}
          {% endwith %}
        {% endfor %}
      </div>
    </section>
  {% endif %}
{% endblock %}
