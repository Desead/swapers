{% extends "base.html" %}
{% load i18n %}
{% block title %}Двухфакторная аутентификация — Swapers{% endblock %}
{% block content %}
  <h1>{% trans "Двухфакторная аутентификация (TOTP)" %}</h1>

  {% if already_enabled %}
    <p>{% trans "2FA уже включена. Можете перейти в" %}<a href="{% url 'admin:index' %}">{% trans "админку" %}</a>.</p>
  {% else %}
    <ol>
      <li>{% trans "Откройте приложение-аутентификатор (Google Authenticator / Authy / 1Password) и отсканируйте QR:" %}</li>
    </ol>
    <p>
      <img alt="QR" src="data:image/png;base64,{{ qr_b64 }}" style="image-rendering: pixelated; border:1px solid #eee; padding:6px; border-radius:8px;">
    </p>
    <ol start="2">
      <li>{% trans "Введите 6-значный код из приложения:" %}</li>
    </ol>
    <form method="post">
      {% csrf_token %}
      <p>
        <input type="text" name="token" inputmode="numeric" pattern="[0-9]*" placeholder="123456" maxlength="6" required>
        <button type="submit" class="btn">{% trans "Подтвердить" %}</button>
      </p>
    </form>
  {% endif %}
{% endblock %}